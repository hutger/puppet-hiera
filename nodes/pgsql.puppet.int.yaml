---
classes:
  - postgresql::globals
  - postgresql::server
  - puppetdb::database::postgresql
  - postgresql::server::db
  - postgresql::server::role

postgresql::globals:
  manage_package_repo:  true
  version:              '12'

postgresql::server:
  listen_addresses:         '${pgsql_host_name}'
  postgres_password:        'kermit'
  ip_mask_allow_all_users:  '0.0.0.0/0'

puppetdb::database::postgresql:
   manage_server: false

postgresql::server::db:
  'gitlabhq_production':
    user:       'gitlab'
    password:   'kermit123'
    grant:      'ALL'
    owner:      'gitlab'

# Alter to 'false' after the first deployment

postgresql::server::role:
  'gitlab':
    superuser: true
  